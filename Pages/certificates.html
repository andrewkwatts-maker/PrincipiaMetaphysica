<!DOCTYPE html>
<!--
    Copyright (c) 2025 Andrew Keith Watts. All rights reserved.

    This is the intellectual property of Andrew Keith Watts. Unauthorized
    reproduction, distribution, or modification of this code, in whole or in part,
    without the express written permission of Andrew Keith Watts is strictly prohibited.

    For inquiries, please contact AndrewKWatts@Gmail.com
-->

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Wolfram Alpha Validation Certificates - Mathematical proofs and derivations from Principia Metaphysica">
    <title>Validation Certificates - Principia Metaphysica</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/pm-common.css">
    <link rel="stylesheet" href="../css/pm-header.css">
    <link rel="stylesheet" href="../css/pm-ux-consistency.css">
    <link rel="stylesheet" href="../css/mobile-responsive.css">
    <link rel="stylesheet" href="../css/auth.css">

    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">

    <!-- MathJax for LaTeX rendering -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        /* Certificate Page Specific Styles */
        .cert-hero {
            background: linear-gradient(135deg, rgba(139, 127, 255, 0.12), rgba(80, 200, 120, 0.08));
            border: 1px solid rgba(139, 127, 255, 0.25);
            border-radius: 20px;
            padding: 3rem;
            margin-bottom: 2.5rem;
            position: relative;
            overflow: hidden;
        }

        .cert-hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, #8b7fff, #51cf66);
        }

        .cert-hero h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, #8b7fff, #51cf66);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1rem;
        }

        .cert-hero .lead {
            font-size: 1.15rem;
            color: var(--text-secondary);
            line-height: 1.8;
            max-width: 900px;
        }

        /* Stats Bar */
        .stats-bar {
            background: linear-gradient(135deg, rgba(139, 127, 255, 0.1), rgba(80, 200, 120, 0.1));
            padding: 1rem 1.5rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--accent-primary);
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Controls Bar */
        .controls-bar {
            background: rgba(26, 31, 58, 0.6);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            border: 1px solid rgba(139, 127, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .control-label {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .control-input {
            padding: 0.875rem 1.25rem;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: #f8f9fa;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .control-input:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(139, 127, 255, 0.5);
            box-shadow: 0 0 0 3px rgba(139, 127, 255, 0.1);
        }

        select.control-input option {
            background: #1a1f3a;
            color: #f8f9fa;
        }

        /* Certificate Card */
        .certificate-card {
            background: rgba(26, 31, 58, 0.6);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 16px;
            border: 1px solid rgba(139, 127, 255, 0.2);
            margin-bottom: 1.5rem;
            overflow: hidden;
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .certificate-card:hover {
            border-color: rgba(139, 127, 255, 0.4);
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
        }

        .cert-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1.5rem;
            cursor: pointer;
            transition: background 0.2s ease;
            user-select: none;
        }

        .cert-header:hover {
            background: rgba(139, 127, 255, 0.1);
        }

        .cert-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex: 1;
        }

        .cert-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, rgba(139, 127, 255, 0.3), rgba(80, 200, 120, 0.3));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .cert-title-group {
            flex: 1;
        }

        .cert-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .cert-id {
            font-size: 0.85rem;
            color: var(--text-muted);
            font-family: 'Fira Code', monospace;
        }

        .cert-meta {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        /* Status Badges */
        .status-badge {
            display: inline-block;
            padding: 0.4rem 0.8rem;
            border-radius: 8px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-verified {
            background: rgba(80, 200, 120, 0.25);
            color: #50c878;
            border: 1px solid rgba(80, 200, 120, 0.5);
        }

        .status-pending {
            background: rgba(255, 193, 7, 0.25);
            color: #ffc107;
            border: 1px solid rgba(255, 193, 7, 0.5);
        }

        .status-mock {
            background: rgba(139, 127, 255, 0.25);
            color: #a99aff;
            border: 1px solid rgba(139, 127, 255, 0.5);
        }

        .category-badge {
            display: inline-block;
            padding: 0.3rem 0.6rem;
            background: rgba(139, 127, 255, 0.2);
            border: 1px solid rgba(139, 127, 255, 0.3);
            border-radius: 6px;
            font-size: 0.7rem;
            font-weight: 600;
            color: var(--accent-primary);
            text-transform: uppercase;
        }

        .expand-icon {
            font-size: 1.5rem;
            color: var(--accent-primary);
            transition: transform 0.3s ease;
        }

        .certificate-card.expanded .expand-icon {
            transform: rotate(90deg);
        }

        /* Certificate Content (expandable) */
        .cert-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease;
        }

        .certificate-card.expanded .cert-content {
            max-height: 5000px;
        }

        .cert-content-inner {
            padding: 0 1.5rem 1.5rem;
            border-top: 1px solid rgba(139, 127, 255, 0.2);
        }

        /* Sections within certificate */
        .cert-section {
            margin-top: 1.5rem;
        }

        .cert-section-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--accent-primary);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .cert-section-title::before {
            content: '';
            width: 4px;
            height: 1em;
            background: var(--accent-primary);
            border-radius: 2px;
        }

        /* Description */
        .cert-description {
            color: var(--text-secondary);
            line-height: 1.7;
            font-size: 0.95rem;
        }

        /* Code Block */
        .cert-code {
            background: rgba(17, 20, 38, 0.6);
            border: 1px solid rgba(139, 127, 255, 0.2);
            border-radius: 12px;
            padding: 1.25rem;
            font-family: 'Fira Code', 'Consolas', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            overflow-x: auto;
            color: #e6e6e6;
            white-space: pre-wrap;
            word-break: break-word;
        }

        .cert-code .comment {
            color: #6a9955;
        }

        .cert-code .keyword {
            color: #569cd6;
        }

        .cert-code .number {
            color: #b5cea8;
        }

        /* Result Display */
        .cert-result {
            background: linear-gradient(135deg, rgba(80, 200, 120, 0.1), rgba(139, 127, 255, 0.1));
            border: 1px solid rgba(80, 200, 120, 0.3);
            border-radius: 12px;
            padding: 1.25rem;
        }

        .result-label {
            font-size: 0.8rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
        }

        .result-value {
            font-size: 1.2rem;
            font-weight: 600;
            color: #51cf66;
            font-family: 'Fira Code', monospace;
        }

        /* Derivation Chain */
        .derivation-chain {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .derivation-chain li {
            padding: 0.75rem 0 0.75rem 2rem;
            position: relative;
            color: var(--text-secondary);
            line-height: 1.6;
            border-left: 2px solid rgba(139, 127, 255, 0.3);
        }

        .derivation-chain li::before {
            content: '';
            position: absolute;
            left: -6px;
            top: 1rem;
            width: 10px;
            height: 10px;
            background: var(--accent-primary);
            border-radius: 50%;
        }

        /* Metadata Grid */
        .cert-meta-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .meta-item {
            background: rgba(17, 20, 38, 0.4);
            padding: 1rem;
            border-radius: 10px;
            border-left: 3px solid var(--accent-primary);
        }

        .meta-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.35rem;
        }

        .meta-value {
            color: var(--text-primary);
            font-size: 0.95rem;
            word-break: break-all;
        }

        /* PROOFS Section */
        .proofs-section {
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 2px solid rgba(139, 127, 255, 0.2);
        }

        .proofs-section h2 {
            font-size: 1.8rem;
            background: linear-gradient(135deg, #8b7fff, #ff7eb6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1.5rem;
        }

        .proof-card {
            background: rgba(26, 31, 58, 0.6);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            border: 1px solid rgba(255, 126, 182, 0.3);
            padding: 2rem;
            margin-bottom: 1.5rem;
        }

        .proof-card h3 {
            color: var(--accent-secondary);
            margin-bottom: 1rem;
        }

        .proof-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(255, 126, 182, 0.15);
            color: #ff7eb6;
            border-radius: 8px;
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            border: 1px solid rgba(255, 126, 182, 0.3);
            transition: all 0.2s ease;
            margin-right: 0.5rem;
            margin-top: 0.5rem;
        }

        .proof-link:hover {
            background: rgba(255, 126, 182, 0.25);
            transform: translateY(-2px);
        }

        /* Loading State */
        .loading-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            padding: 4rem 2rem;
            min-height: 300px;
        }

        .loading-spinner {
            width: 48px;
            height: 48px;
            border: 4px solid rgba(139, 127, 255, 0.2);
            border-top-color: var(--accent-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            color: var(--text-muted);
            font-size: 0.95rem;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--text-muted);
        }

        .empty-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .cert-hero {
                padding: 2rem;
            }

            .cert-hero h1 {
                font-size: 1.8rem;
            }

            .cert-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }

            .cert-meta {
                width: 100%;
                justify-content: space-between;
            }

            .stats-bar {
                flex-direction: column;
            }

            .cert-meta-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Reduce motion for accessibility */
        @media (prefers-reduced-motion: reduce) {
            .certificate-card,
            .cert-content,
            .expand-icon {
                transition: none;
            }
        }
    </style>
</head>
<body class="auth-loading">
  <div id="main-content" style="display: none;">
    <!-- Header injected by pm-header.js -->

    <main>
        <nav class="breadcrumb" aria-label="Breadcrumb">
            <a href="../index.html">Home</a>
            <span class="separator">/</span>
            <span>Validation Certificates</span>
        </nav>

        <div class="cert-hero">
            <h1>Validation Certificates</h1>
            <p class="lead">
                Mathematical proof certificates from Wolfram Alpha derivations and symbolic computations.
                Each certificate documents a specific mathematical validation within the Principia Metaphysica framework,
                including the derivation code, expected results, and verification status.
            </p>
        </div>

        <!-- Statistics Bar -->
        <div id="stats-bar" class="stats-bar" style="display: none;">
            <div class="stat-item">
                <div class="stat-value" id="stat-total">0</div>
                <div class="stat-label">Total Certificates</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="stat-verified">0</div>
                <div class="stat-label">Verified</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="stat-pending">0</div>
                <div class="stat-label">Pending</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="stat-categories">0</div>
                <div class="stat-label">Categories</div>
            </div>
        </div>

        <!-- Controls & Filters -->
        <div class="controls-bar" id="controls-bar" style="display: none;">
            <div class="controls-grid">
                <div class="control-group">
                    <label class="control-label" for="search-box">Search</label>
                    <input
                        type="text"
                        id="search-box"
                        class="control-input"
                        placeholder="Search by name, ID, or description..."
                    >
                </div>
                <div class="control-group">
                    <label class="control-label" for="category-filter">Category</label>
                    <select id="category-filter" class="control-input">
                        <option value="">All Categories</option>
                    </select>
                </div>
                <div class="control-group">
                    <label class="control-label" for="status-filter">Status</label>
                    <select id="status-filter" class="control-input">
                        <option value="">All Statuses</option>
                        <option value="verified">Verified</option>
                        <option value="pending">Pending</option>
                        <option value="mock">Mock</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Loading State -->
        <div id="loading-state" class="loading-container">
            <div class="loading-spinner"></div>
            <p class="loading-text">Loading certificates from AutoGenerated/certificates/...</p>
        </div>

        <!-- Certificate Container -->
        <div id="certificate-container" style="display: none;">
            <!-- Certificates will be dynamically inserted here -->
        </div>

        <!-- Empty State -->
        <div id="empty-state" class="empty-state" style="display: none;">
            <div class="empty-icon">&#128269;</div>
            <h3>No certificates found</h3>
            <p>Try adjusting your search or filter criteria.</p>
        </div>

        <!-- PROOFS Section -->
        <div class="proofs-section" id="proofs-section" style="display: none;">
            <h2>Formal Proof Documents</h2>
            <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
                Extended mathematical proofs and Wolfram Mathematica notebooks documenting the theoretical foundations.
            </p>
            <div id="proofs-container">
                <!-- PROOFS will be inserted here -->
            </div>
        </div>

    </main>

    <footer>
        <p>
            <strong>Principia Metaphysica</strong><br>
            &copy; 2025 Andrew Keith Watts. All rights reserved.
        </p>
    </footer>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

  <script type="module">
    import { injectHeader } from '../js/pm-header.js';
    import { setupAuthGuard } from '../js/auth-guard.js';

    // Inject header first
    document.addEventListener('DOMContentLoaded', () => {
        injectHeader('certificates');
    });

    // Setup auth after header
    setupAuthGuard('certificates');
  </script>

  <!-- Certificate Database Logic -->
  <script>
    // List of certificate files to load
    const CERTIFICATE_FILES = [
        'alpha_geometric.json',
        'betti_three.json',
        'c_kaf_derivation.json',
        'chi_eff_derivation.json',
        'delta_cp_io.json',
        'delta_cp_no.json',
        'einstein_field_variation.json',
        'g2_holonomy_group.json',
        'h0_hubble_tension.json',
        'higgs_mass_geometric.json',
        'hubble_evolution.json',
        'k_gimel_derivation.json',
        'm_gut_geometric.json',
        'mass_ratio_geometric.json',
        'microtubule_pitch.json',
        'neutrino_mass_splittings.json',
        'orch_or_collapse.json',
        'proton_lifetime.json',
        's8_viscosity.json',
        'scalar_field_eom.json',
        'theta_12_tribimaximal.json',
        'theta_13_no.json',
        'theta_23_no.json',
        'three_generations.json',
        'w_cpl_parameterization.json',
        'w0_dark_energy.json',
        'wa_dark_energy.json'
    ];

    // PROOFS files
    const PROOF_FILES = [
        {
            name: 'Mirror Brane Metric Derivation',
            file: 'Mirror_Brane_Metric_Derivation_v16_2.md',
            description: 'Formal proof of w0 = -11/13 from Mirror Brane symmetry and 26D bulk decomposition.'
        },
        {
            name: 'Mirror Brane Resonance',
            file: 'Mirror_Brane_Resonance_v16_2.wl',
            description: 'Wolfram Mathematica symbolic validation of the fine structure constant derivation.'
        },
        {
            name: 'Proof Manifest v16.2',
            file: 'PROOF_MANIFEST_v16_2.md',
            description: 'Complete proof chain and validation status for all PM v16.2 derivations.'
        }
    ];

    let allCertificates = [];
    let filteredCertificates = [];

    // Load all certificates
    async function loadCertificates() {
        const basePaths = [
            '../simulations/AutoGenerated/certificates/',
            '../AutoGenerated/certificates/',
            '/simulations/AutoGenerated/certificates/',
            '/AutoGenerated/certificates/'
        ];

        let loadedCount = 0;
        let certificates = [];

        for (const file of CERTIFICATE_FILES) {
            for (const basePath of basePaths) {
                try {
                    const response = await fetch(basePath + file);
                    if (response.ok) {
                        const cert = await response.json();
                        certificates.push(cert);
                        loadedCount++;
                        break;
                    }
                } catch (e) {
                    continue;
                }
            }
        }

        if (loadedCount === 0) {
            throw new Error('Could not load any certificate files');
        }

        console.log(`Loaded ${loadedCount} certificates`);
        return certificates;
    }

    // Initialize the page
    async function init() {
        try {
            allCertificates = await loadCertificates();
            filteredCertificates = [...allCertificates];

            // Initialize filters
            initializeFilters();

            // Update statistics
            updateStatistics();

            // Render certificates
            renderCertificates();

            // Render PROOFS section
            renderProofs();

            // Show content
            document.getElementById('loading-state').style.display = 'none';
            document.getElementById('certificate-container').style.display = 'block';
            document.getElementById('stats-bar').style.display = 'flex';
            document.getElementById('controls-bar').style.display = 'block';
            document.getElementById('proofs-section').style.display = 'block';

        } catch (error) {
            console.error('Error loading certificates:', error);
            document.getElementById('loading-state').innerHTML = `
                <div class="empty-icon">&#9888;</div>
                <h3>Error Loading Certificates</h3>
                <p style="color: #ff7eb6;">${error.message}</p>
                <p style="margin-top: 1rem; color: var(--text-muted);">
                    Expected files in: <code>simulations/AutoGenerated/certificates/</code>
                </p>
            `;
        }
    }

    // Initialize filter dropdowns
    function initializeFilters() {
        const categories = [...new Set(allCertificates.map(c => c.category).filter(Boolean))].sort();
        const categoryFilter = document.getElementById('category-filter');

        categories.forEach(cat => {
            const option = document.createElement('option');
            option.value = cat;
            option.textContent = cat;
            categoryFilter.appendChild(option);
        });

        // Add event listeners
        document.getElementById('search-box').addEventListener('input', applyFilters);
        document.getElementById('category-filter').addEventListener('change', applyFilters);
        document.getElementById('status-filter').addEventListener('change', applyFilters);
    }

    // Apply filters
    function applyFilters() {
        const search = document.getElementById('search-box').value.toLowerCase();
        const category = document.getElementById('category-filter').value;
        const status = document.getElementById('status-filter').value;

        filteredCertificates = allCertificates.filter(cert => {
            // Search filter
            const matchesSearch = !search ||
                cert.label?.toLowerCase().includes(search) ||
                cert.proof_id?.toLowerCase().includes(search) ||
                cert.mathematical_goal?.toLowerCase().includes(search) ||
                cert.theoretical_significance?.toLowerCase().includes(search);

            // Category filter
            const matchesCategory = !category || cert.category === category;

            // Status filter
            let matchesStatus = true;
            if (status) {
                const isVerified = cert.verified === true || cert.verification_status === 'verified';
                const isMock = cert.result?.includes('[Mock]') || !isVerified;
                if (status === 'verified') matchesStatus = isVerified;
                else if (status === 'pending') matchesStatus = !isVerified && !isMock;
                else if (status === 'mock') matchesStatus = isMock;
            }

            return matchesSearch && matchesCategory && matchesStatus;
        });

        renderCertificates();
        updateStatistics();
    }

    // Update statistics
    function updateStatistics() {
        const verified = filteredCertificates.filter(c =>
            c.verified === true || c.verification_status === 'verified'
        ).length;

        const pending = filteredCertificates.filter(c =>
            !c.verified && c.verification_status !== 'verified' && !c.result?.includes('[Mock]')
        ).length;

        const categories = new Set(filteredCertificates.map(c => c.category).filter(Boolean)).size;

        document.getElementById('stat-total').textContent = filteredCertificates.length;
        document.getElementById('stat-verified').textContent = verified;
        document.getElementById('stat-pending').textContent = pending;
        document.getElementById('stat-categories').textContent = categories;
    }

    // Render certificates
    function renderCertificates() {
        const container = document.getElementById('certificate-container');
        const emptyState = document.getElementById('empty-state');

        if (filteredCertificates.length === 0) {
            container.style.display = 'none';
            emptyState.style.display = 'block';
            return;
        }

        container.style.display = 'block';
        emptyState.style.display = 'none';

        container.innerHTML = filteredCertificates.map(cert => renderCertificateCard(cert)).join('');

        // Add click handlers for expanding cards
        container.querySelectorAll('.cert-header').forEach(header => {
            header.addEventListener('click', () => {
                header.closest('.certificate-card').classList.toggle('expanded');
            });
        });

        // Re-render MathJax if available
        if (window.MathJax) {
            MathJax.typesetPromise([container]).catch(err => console.log('MathJax error:', err));
        }
    }

    // Render a single certificate card
    function renderCertificateCard(cert) {
        const isVerified = cert.verified === true || cert.verification_status === 'verified';
        const isMock = cert.result?.includes('[Mock]');
        const statusClass = isVerified ? 'status-verified' : (isMock ? 'status-mock' : 'status-pending');
        const statusText = isVerified ? 'Verified' : (isMock ? 'Mock' : 'Pending');

        const code = cert.wolfram_code || cert.wl_code || '';
        const result = cert.expected_result || cert.result || 'N/A';
        const description = cert.mathematical_goal || cert.theoretical_significance || '';

        // Build derivation chain HTML
        let derivationHTML = '';
        if (cert.derivation_chain && Array.isArray(cert.derivation_chain)) {
            derivationHTML = `
                <div class="cert-section">
                    <h4 class="cert-section-title">Derivation Chain</h4>
                    <ol class="derivation-chain">
                        ${cert.derivation_chain.map(step => `<li>${escapeHtml(step)}</li>`).join('')}
                    </ol>
                </div>
            `;
        }

        // Build metadata grid
        let metaHTML = `
            <div class="cert-section">
                <h4 class="cert-section-title">Certificate Metadata</h4>
                <div class="cert-meta-grid">
                    <div class="meta-item">
                        <div class="meta-label">Proof ID</div>
                        <div class="meta-value">${escapeHtml(cert.proof_id || 'N/A')}</div>
                    </div>
                    <div class="meta-item">
                        <div class="meta-label">Hash</div>
                        <div class="meta-value">${escapeHtml(cert.hash || 'N/A')}</div>
                    </div>
                    <div class="meta-item">
                        <div class="meta-label">Timestamp</div>
                        <div class="meta-value">${formatTimestamp(cert.timestamp)}</div>
                    </div>
                    ${cert.category ? `
                    <div class="meta-item">
                        <div class="meta-label">Category</div>
                        <div class="meta-value">${escapeHtml(cert.category)}</div>
                    </div>
                    ` : ''}
                </div>
            </div>
        `;

        // Additional details for rich certificates
        let additionalHTML = '';
        if (cert.experimental_comparison) {
            additionalHTML += `
                <div class="cert-section">
                    <h4 class="cert-section-title">Experimental Comparison</h4>
                    <pre class="cert-code">${escapeHtml(JSON.stringify(cert.experimental_comparison, null, 2))}</pre>
                </div>
            `;
        }

        if (cert.geometry) {
            additionalHTML += `
                <div class="cert-section">
                    <h4 class="cert-section-title">Geometric Details</h4>
                    <pre class="cert-code">${escapeHtml(JSON.stringify(cert.geometry, null, 2))}</pre>
                </div>
            `;
        }

        return `
            <div class="certificate-card">
                <div class="cert-header">
                    <div class="cert-info">
                        <div class="cert-icon">&#128220;</div>
                        <div class="cert-title-group">
                            <div class="cert-title">${escapeHtml(cert.label || cert.proof_id)}</div>
                            <div class="cert-id">${escapeHtml(cert.proof_id)}</div>
                        </div>
                    </div>
                    <div class="cert-meta">
                        ${cert.category ? `<span class="category-badge">${escapeHtml(cert.category)}</span>` : ''}
                        <span class="status-badge ${statusClass}">${statusText}</span>
                        <span class="expand-icon">&#9654;</span>
                    </div>
                </div>
                <div class="cert-content">
                    <div class="cert-content-inner">
                        ${description ? `
                        <div class="cert-section">
                            <h4 class="cert-section-title">Description</h4>
                            <p class="cert-description">${escapeHtml(description)}</p>
                        </div>
                        ` : ''}

                        <div class="cert-section">
                            <h4 class="cert-section-title">Wolfram Code</h4>
                            <pre class="cert-code language-wolfram">${escapeHtml(code.trim())}</pre>
                        </div>

                        <div class="cert-section">
                            <h4 class="cert-section-title">Result</h4>
                            <div class="cert-result">
                                <div class="result-label">${isVerified ? 'Verified Output' : 'Expected Output'}</div>
                                <div class="result-value">${escapeHtml(result)}</div>
                            </div>
                        </div>

                        ${derivationHTML}
                        ${metaHTML}
                        ${additionalHTML}

                        ${cert.theoretical_significance && cert.theoretical_significance !== description ? `
                        <div class="cert-section">
                            <h4 class="cert-section-title">Theoretical Significance</h4>
                            <p class="cert-description">${escapeHtml(cert.theoretical_significance)}</p>
                        </div>
                        ` : ''}
                    </div>
                </div>
            </div>
        `;
    }

    // Render PROOFS section
    function renderProofs() {
        const container = document.getElementById('proofs-container');
        container.innerHTML = PROOF_FILES.map(proof => `
            <div class="proof-card">
                <h3>${escapeHtml(proof.name)}</h3>
                <p class="cert-description">${escapeHtml(proof.description)}</p>
                <a href="../PROOFS/${proof.file}" class="proof-link" target="_blank">
                    &#128196; View ${proof.file.endsWith('.wl') ? 'Mathematica Notebook' : 'Document'}
                </a>
            </div>
        `).join('');
    }

    // Utility functions
    function escapeHtml(text) {
        if (!text) return '';
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }

    function formatTimestamp(ts) {
        if (!ts) return 'N/A';
        try {
            return new Date(ts).toLocaleString();
        } catch {
            return ts;
        }
    }

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
