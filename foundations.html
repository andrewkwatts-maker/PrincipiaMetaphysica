<!DOCTYPE html>
<!--
    Principia Metaphysica - Foundations & Beginner's Guide
    Copyright (c) 2025-2026 Andrew Keith Watts. All rights reserved.

    An introductory guide to the theory, auto-populated from theory_output.json
-->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Foundations - Principia Metaphysica</title>

    <!-- MathJax Configuration -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                tags: 'ams'
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- PM Dynamic Loaders -->
    <script src="js/pm-constants-loader.js"></script>
    <script src="js/pm-formula-loader.js"></script>
    <script src="js/pm-section-renderer.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;0,700;1,400&family=Source+Sans+Pro:wght@400;600&family=Source+Code+Pro:wght@400;500&display=swap');

        :root {
            --bg-dark: #0a0a0f;
            --bg-card: #1a1a2e;
            --bg-card-hover: #252540;
            --text-primary: #e0e0e0;
            --text-secondary: #b0b0b0;
            --accent-primary: #8b7fff;
            --accent-secondary: #ff7eb6;
            --accent-success: #51cf66;
            --accent-info: #4facfe;
            --border-primary: rgba(139, 127, 255, 0.2);
            --border-secondary: rgba(255, 255, 255, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Crimson Text', Georgia, serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.7;
            font-size: 16px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Header */
        .page-header {
            text-align: center;
            padding: 3rem 0;
            margin-bottom: 3rem;
            background: linear-gradient(135deg, rgba(139, 127, 255, 0.1), rgba(255, 126, 182, 0.05));
            border-radius: 20px;
            border: 2px solid var(--border-primary);
        }

        .page-header h1 {
            font-size: 3rem;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .page-header .subtitle {
            font-size: 1.3rem;
            color: var(--text-secondary);
            font-style: italic;
        }

        .page-header .stats {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }

        .stat-badge {
            background: rgba(139, 127, 255, 0.2);
            padding: 0.5rem 1.5rem;
            border-radius: 20px;
            border: 1px solid var(--accent-primary);
            font-size: 0.9rem;
        }

        .stat-badge strong {
            color: var(--accent-primary);
            font-size: 1.2rem;
        }

        /* Navigation */
        .nav-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .nav-tab {
            padding: 0.75rem 1.5rem;
            background: var(--bg-card);
            border: 1px solid var(--border-primary);
            border-radius: 10px;
            color: var(--text-primary);
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .nav-tab:hover, .nav-tab.active {
            background: var(--accent-primary);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(139, 127, 255, 0.3);
        }

        /* Learning Path */
        .learning-path {
            margin-bottom: 3rem;
        }

        .path-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .path-header h2 {
            color: var(--accent-primary);
            font-size: 2rem;
        }

        .path-icon {
            font-size: 2.5rem;
        }

        .difficulty-levels {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .level-card {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 1.5rem;
            border: 2px solid var(--border-primary);
            transition: all 0.3s ease;
        }

        .level-card:hover {
            border-color: var(--accent-primary);
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(139, 127, 255, 0.2);
        }

        .level-card.beginner {
            border-color: var(--accent-success);
        }

        .level-card.intermediate {
            border-color: var(--accent-info);
        }

        .level-card.advanced {
            border-color: var(--accent-secondary);
        }

        .level-card h3 {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }

        .level-card.beginner h3 { color: var(--accent-success); }
        .level-card.intermediate h3 { color: var(--accent-info); }
        .level-card.advanced h3 { color: var(--accent-secondary); }

        .level-badge {
            font-size: 0.8rem;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            background: rgba(139, 127, 255, 0.2);
            font-weight: normal;
        }

        /* Concept Cards */
        .concept-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .concept-card {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 2rem;
            border: 1px solid var(--border-primary);
            transition: all 0.3s ease;
        }

        .concept-card:hover {
            border-color: var(--accent-primary);
            box-shadow: 0 8px 24px rgba(139, 127, 255, 0.15);
        }

        .concept-card h3 {
            color: var(--accent-primary);
            margin-bottom: 1rem;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .concept-icon {
            font-size: 1.8rem;
        }

        .concept-description {
            color: var(--text-secondary);
            margin-bottom: 1rem;
            line-height: 1.8;
        }

        /* Prerequisites */
        .prerequisites {
            background: rgba(79, 172, 254, 0.1);
            border-left: 4px solid var(--accent-info);
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: 0 12px 12px 0;
        }

        .prerequisites h4 {
            color: var(--accent-info);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .prerequisites ul {
            list-style: none;
            padding-left: 0;
        }

        .prerequisites li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
        }

        .prerequisites li:before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: var(--accent-info);
            font-weight: bold;
        }

        /* Key Formulas */
        .key-formulas {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 2rem;
            margin: 2rem 0;
            border: 2px solid var(--border-primary);
        }

        .key-formulas h3 {
            color: var(--accent-primary);
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
        }

        .formula-item {
            background: rgba(139, 127, 255, 0.05);
            padding: 1.5rem;
            margin: 1rem 0;
            border-radius: 12px;
            border-left: 4px solid var(--accent-primary);
        }

        .formula-item .formula-label {
            color: var(--accent-secondary);
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .formula-item .formula-description {
            color: var(--text-secondary);
            font-size: 0.95rem;
            margin-top: 0.75rem;
            font-style: italic;
        }

        /* Parameters Display */
        .param-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }

        .param-item {
            background: rgba(139, 127, 255, 0.05);
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid var(--border-primary);
        }

        .param-label {
            color: var(--accent-info);
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .param-value {
            font-size: 1.2rem;
            color: var(--text-primary);
            font-family: 'Source Code Pro', monospace;
        }

        /* Section Links */
        .section-links {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 2rem;
            margin: 2rem 0;
        }

        .section-links h3 {
            color: var(--accent-primary);
            margin-bottom: 1.5rem;
        }

        .section-link-item {
            display: flex;
            align-items: center;
            padding: 1rem;
            margin: 0.5rem 0;
            background: rgba(139, 127, 255, 0.05);
            border-radius: 8px;
            border-left: 4px solid var(--accent-primary);
            text-decoration: none;
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .section-link-item:hover {
            background: rgba(139, 127, 255, 0.15);
            transform: translateX(8px);
        }

        .section-number {
            font-weight: bold;
            color: var(--accent-primary);
            margin-right: 1rem;
            font-size: 1.2rem;
            min-width: 2rem;
        }

        /* Expandable Details */
        .expandable {
            margin: 1.5rem 0;
        }

        .expand-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: var(--bg-card);
            padding: 1rem 1.5rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid var(--border-primary);
        }

        .expand-header:hover {
            background: var(--bg-card-hover);
            border-color: var(--accent-primary);
        }

        .expand-header h4 {
            color: var(--accent-primary);
            margin: 0;
        }

        .expand-arrow {
            transition: transform 0.3s ease;
            color: var(--accent-primary);
            font-size: 1.5rem;
        }

        .expand-content {
            display: none;
            padding: 1.5rem;
            background: rgba(139, 127, 255, 0.05);
            border: 1px solid var(--border-primary);
            border-top: none;
            border-radius: 0 0 12px 12px;
            margin-top: -1px;
        }

        .expand-content.active {
            display: block;
        }

        .expand-header.active .expand-arrow {
            transform: rotate(180deg);
        }

        /* Analogy Box */
        .analogy-box {
            background: linear-gradient(135deg, rgba(81, 207, 102, 0.1), rgba(79, 172, 254, 0.1));
            border-left: 4px solid var(--accent-success);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0 12px 12px 0;
        }

        .analogy-box h4 {
            color: var(--accent-success);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Loading States */
        .pm-loading {
            color: var(--accent-info);
            font-style: italic;
        }

        .pm-error {
            color: #ff6b6b;
            font-style: italic;
        }

        .pm-loaded {
            color: var(--accent-primary);
            font-weight: 600;
        }

        /* Site Header Navigation */
        .site-nav-header {
            background: rgba(26, 31, 58, 0.8);
            backdrop-filter: blur(20px) saturate(180%);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }

        .site-nav-header nav ul {
            list-style: none;
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin: 0;
            padding: 0;
        }

        .site-nav-header nav a {
            color: var(--text-secondary);
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 0.95rem;
            font-weight: 500;
        }

        .site-nav-header nav a:hover {
            background: rgba(139, 127, 255, 0.2);
            color: var(--text-primary);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .page-header h1 {
                font-size: 2rem;
            }

            .concept-grid,
            .difficulty-levels {
                grid-template-columns: 1fr;
            }

            .nav-tabs {
                flex-direction: column;
            }

            .site-nav-header nav ul {
                flex-direction: column;
                gap: 0.25rem;
            }

            .site-nav-header nav a {
                padding: 0.75rem 1rem;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <!-- Site Navigation Header -->
    <header class="site-nav-header">
        <div style="max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1.5rem;">
            <div style="font-size: 1.5rem; font-weight: 700; color: var(--text-primary);">
                Principia Metaphysica
            </div>
            <nav>
                <ul>
                    <li><a href="index.html#abstract">Abstract</a></li>
                    <li><a href="beginners-guide.html">Beginner's Guide</a></li>
                    <li><a href="sections.html">Sections</a></li>
                    <li><a href="foundations/index.html">Foundations</a></li>
                    <li><a href="references.html">References</a></li>
                    <li><a href="formulas.html">Formulas</a></li>
                    <li><a href="parameters.html">Parameters</a></li>
                    <li><a href="paper.html">Paper</a></li>
                    <li><a href="simulations.html">Simulations</a></li>
                    <li class="user-controls-nav">
                        <div class="user-controls">
                            <img id="user-avatar" src="images/default-avatar.svg" alt="User">
                            <span id="user-email"></span>
                            <button id="logout-btn">Logout</button>
                        </div>
                        <button id="header-login-btn" class="header-login-btn">
                            <img src="images/google-icon.svg" alt="G" class="google-icon-small">
                            Login
                        </button>
                    </li>
                </ul>
            </nav>
        </div>
    </header>

    <div class="container">
        <!-- Page Header -->
        <header class="page-header">
            <h1>Foundations of Principia Metaphysica</h1>
            <p class="subtitle">A Progressive Guide to Geometric Unification</p>
            <div class="stats">
                <div class="stat-badge">
                    <strong id="formula-count">...</strong> Formulas
                </div>
                <div class="stat-badge">
                    <strong id="section-count">...</strong> Sections
                </div>
                <div class="stat-badge">
                    <strong id="dimension-count">26 ‚Üí 4</strong> Dimensions
                </div>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <nav class="nav-tabs">
            <a href="#basics" class="nav-tab active" onclick="showTab('basics')">Basics</a>
            <a href="#concepts" class="nav-tab" onclick="showTab('concepts')">Key Concepts</a>
            <a href="#formulas" class="nav-tab" onclick="showTab('formulas')">Core Formulas</a>
            <a href="#sections" class="nav-tab" onclick="showTab('sections')">Detailed Sections</a>
        </nav>

        <!-- Tab: Basics -->
        <div id="basics-content" class="tab-content">
            <section class="learning-path">
                <div class="path-header">
                    <span class="path-icon">üéì</span>
                    <h2>Learning Path</h2>
                </div>

                <div class="prerequisites">
                    <h4>üìã Recommended Prerequisites</h4>
                    <ul>
                        <li>Basic understanding of differential geometry (manifolds, metrics)</li>
                        <li>Familiarity with the Standard Model of particle physics</li>
                        <li>Knowledge of general relativity fundamentals</li>
                        <li>Basic string theory concepts (optional but helpful)</li>
                        <li>Kaluza-Klein theory and compactification (recommended)</li>
                    </ul>
                </div>

                <div class="difficulty-levels">
                    <div class="level-card beginner">
                        <h3>
                            üå± Beginner
                            <span class="level-badge">Start Here</span>
                        </h3>
                        <p><strong>What you'll learn:</strong></p>
                        <ul id="beginner-topics" style="margin-top: 1rem; line-height: 2;">
                            <li>The basic idea: unifying physics through geometry</li>
                            <li>Why 26 dimensions? (Bosonic string theory critical dimension)</li>
                            <li>What is a G‚ÇÇ manifold?</li>
                            <li>How dimensions reduce: 26 ‚Üí 13 ‚Üí 7 ‚Üí 4</li>
                            <li>The role of Sp(2,R) gauge symmetry</li>
                        </ul>
                        <div style="margin-top: 1.5rem;">
                            <strong>Key Formula:</strong>
                            <div class="formula-item">
                                <div class="formula-label">Dimension Progression</div>
                                <div style="font-size: 1.2rem; text-align: center; margin: 1rem 0;">
                                    D = <span data-pm-value="dimensions.D_BULK" class="pm-value">26</span> ‚Üí
                                    <span data-pm-value="dimensions.D_AFTER_SP2R" class="pm-value">13</span> ‚Üí
                                    <span data-pm-value="dimensions.D_G2" class="pm-value">7</span> ‚Üí
                                    <span data-pm-value="dimensions.D_OBSERVABLE" class="pm-value">4</span>
                                </div>
                                <div class="formula-description">
                                    From bosonic string theory to observable spacetime
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="level-card intermediate">
                        <h3>
                            üî¨ Intermediate
                            <span class="level-badge">Build Understanding</span>
                        </h3>
                        <p><strong>What you'll learn:</strong></p>
                        <ul id="intermediate-topics" style="margin-top: 1rem; line-height: 2;">
                            <li>Fermion generations from G‚ÇÇ topology (œá = -16)</li>
                            <li>Gauge coupling unification and evolution</li>
                            <li>The Pneuma Lagrangian and stress-energy</li>
                            <li>Kaluza-Klein spectrum and mass scales</li>
                            <li>Neutrino masses via geometric seesaw</li>
                        </ul>
                        <div style="margin-top: 1.5rem;">
                            <strong>Key Formula:</strong>
                            <div class="formula-item">
                                <div class="formula-label">Generation Number</div>
                                <div id="gen-formula-display" style="text-align: center; margin: 1rem 0; font-size: 1.1rem;">
                                    Loading formula...
                                </div>
                                <div class="formula-description">
                                    Three generations emerge from G‚ÇÇ Euler characteristic
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="level-card advanced">
                        <h3>
                            üöÄ Advanced
                            <span class="level-badge">Deep Dive</span>
                        </h3>
                        <p><strong>What you'll learn:</strong></p>
                        <ul id="advanced-topics" style="margin-top: 1rem; line-height: 2;">
                            <li>Full derivation of phenomenological predictions</li>
                            <li>Proton decay mechanisms and lifetime bounds</li>
                            <li>CMB anomalies from bubble collisions</li>
                            <li>W/Z boson mass evolution (DESI DR2 data)</li>
                            <li>Connections to 2T-physics and holography</li>
                        </ul>
                        <div style="margin-top: 1.5rem;">
                            <strong>Key Prediction:</strong>
                            <div class="formula-item">
                                <div class="formula-label">Proton Lifetime</div>
                                <div style="text-align: center; margin: 1rem 0; font-size: 1.3rem;">
                                    œÑ<sub>p</sub> ‚âà <span data-pm-value="simulations.proton_decay.tau_p_years" data-format="scientific:2" class="pm-value">...</span> years
                                </div>
                                <div class="formula-description">
                                    Testable prediction from geometric proton decay
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="analogy-box">
                    <h4>üí° The Big Picture Analogy</h4>
                    <p>
                        Think of our universe as a 4D shadow cast by a higher-dimensional geometric structure,
                        much like a 2D shadow is cast by a 3D object. The theory proposes that all fundamental
                        particles and forces are not separate entities, but different aspects of the <em>geometry</em>
                        of a special 7-dimensional space called a G‚ÇÇ manifold. Just as a prism splits white light
                        into a rainbow, the compactification of extra dimensions "splits" geometric structure into
                        the particles and forces we observe.
                    </p>
                </div>

                <!-- Section Summaries (Loaded Dynamically) -->
                <div id="section-summaries" style="margin-top: 3rem;">
                    <h2 style="color: var(--accent-primary); margin-bottom: 1.5rem; font-size: 2rem;">
                        üìñ Theory Overview
                    </h2>
                    <div id="summaries-grid" class="concept-grid">
                        <!-- Will be populated from sections.json -->
                        <p style="text-align: center; color: var(--accent-info);">Loading section summaries...</p>
                    </div>
                </div>
            </section>
        </div>

        <!-- Tab: Key Concepts -->
        <div id="concepts-content" class="tab-content" style="display: none;">
            <section>
                <h2 style="color: var(--accent-primary); margin-bottom: 2rem; font-size: 2rem;">
                    üîë Core Concepts
                </h2>

                <div class="concept-grid">
                    <div class="concept-card">
                        <h3>
                            <span class="concept-icon">üìê</span>
                            G‚ÇÇ Manifolds
                        </h3>
                        <p class="concept-description">
                            Special 7-dimensional spaces with exceptional holonomy group G‚ÇÇ. These manifolds
                            have unique properties that preserve supersymmetry and provide natural compactification
                            from 11D M-theory to 4D spacetime.
                        </p>
                        <div class="expandable">
                            <div class="expand-header" onclick="toggleExpand(this)">
                                <h4>Learn More</h4>
                                <span class="expand-arrow">‚ñº</span>
                            </div>
                            <div class="expand-content">
                                <p><strong>Why G‚ÇÇ?</strong></p>
                                <ul style="margin: 1rem 0; line-height: 1.8;">
                                    <li>Only compact 7D manifolds that preserve N=1 SUSY</li>
                                    <li>Euler characteristic œá = -16 predicts 3 generations</li>
                                    <li>Natural emergence of SU(3) √ó SU(2) √ó U(1) gauge symmetry</li>
                                    <li>Geometric explanation for fermion chirality</li>
                                </ul>
                                <p style="margin-top: 1rem;">
                                    <strong>Mathematical Foundation:</strong> A G‚ÇÇ manifold is defined by a closed
                                    and co-closed associative 3-form œÜ, which determines both the metric and the
                                    holonomy group.
                                </p>
                            </div>
                        </div>
                    </div>

                    <div class="concept-card">
                        <h3>
                            <span class="concept-icon">üéØ</span>
                            Dimensional Reduction
                        </h3>
                        <p class="concept-description">
                            The process by which extra dimensions become "compactified" or curled up at tiny scales,
                            reducing the effective dimensionality from 26D to our observable 4D spacetime.
                        </p>
                        <div class="expandable">
                            <div class="expand-header" onclick="toggleExpand(this)">
                                <h4>Learn More</h4>
                                <span class="expand-arrow">‚ñº</span>
                            </div>
                            <div class="expand-content">
                                <p><strong>The Reduction Chain:</strong></p>
                                <ol style="margin: 1rem 0 1rem 1.5rem; line-height: 2;">
                                    <li><strong>26D ‚Üí 13D:</strong> Sp(2,R) gauge symmetry breaking</li>
                                    <li><strong>13D ‚Üí 7D:</strong> Further compactification to G‚ÇÇ manifold</li>
                                    <li><strong>7D ‚Üí 4D:</strong> G‚ÇÇ compactification to Minkowski spacetime</li>
                                </ol>
                                <p style="margin-top: 1rem;">
                                    Each reduction step leaves signatures in the low-energy physics, manifesting as
                                    particle masses, coupling constants, and symmetry patterns.
                                </p>
                            </div>
                        </div>
                    </div>

                    <div class="concept-card">
                        <h3>
                            <span class="concept-icon">‚öõÔ∏è</span>
                            Gauge Unification
                        </h3>
                        <p class="concept-description">
                            All three fundamental forces (strong, weak, electromagnetic) emerge from the geometry
                            of the G‚ÇÇ manifold and unify at high energies around the GUT scale.
                        </p>
                        <div class="expandable">
                            <div class="expand-header" onclick="toggleExpand(this)">
                                <h4>Learn More</h4>
                                <span class="expand-arrow">‚ñº</span>
                            </div>
                            <div class="expand-content">
                                <p><strong>Unification Energy Scale:</strong></p>
                                <div style="text-align: center; margin: 1rem 0; font-size: 1.3rem;">
                                    Œõ<sub>GUT</sub> ‚âà <span data-pm-value="simulations.gauge_unification.lambda_gut_gev"
                                        data-format="scientific:2" class="pm-value">...</span> GeV
                                </div>
                                <p style="margin-top: 1rem;">
                                    <strong>Running Couplings:</strong> The three gauge couplings Œ±‚ÇÅ, Œ±‚ÇÇ, Œ±‚ÇÉ
                                    evolve with energy according to the renormalization group equations and
                                    converge at the GUT scale, with corrections from the G‚ÇÇ geometry.
                                </p>
                            </div>
                        </div>
                    </div>

                    <div class="concept-card">
                        <h3>
                            <span class="concept-icon">üåä</span>
                            Pneuma Field
                        </h3>
                        <p class="concept-description">
                            A geometric scalar field that couples to the G‚ÇÇ structure, providing stress-energy
                            contributions and potential cosmological effects (dark energy candidate).
                        </p>
                        <div class="expandable">
                            <div class="expand-header" onclick="toggleExpand(this)">
                                <h4>Learn More</h4>
                                <span class="expand-arrow">‚ñº</span>
                            </div>
                            <div class="expand-content">
                                <p><strong>Physical Role:</strong></p>
                                <ul style="margin: 1rem 0; line-height: 1.8;">
                                    <li>Modulates G‚ÇÇ structure through coupling parameter Œæ</li>
                                    <li>Contributes to effective stress-energy tensor</li>
                                    <li>May drive cosmic acceleration (quintessence-like)</li>
                                    <li>Affects stability and dynamics of compactification</li>
                                </ul>
                                <div style="margin-top: 1rem;">
                                    <strong>Coupling Parameter:</strong>
                                    <div style="text-align: center; margin: 0.5rem 0; font-size: 1.2rem;">
                                        Œæ = <span data-pm-value="simulations.pneuma_stability.xi" class="pm-value">...</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="concept-card">
                        <h3>
                            <span class="concept-icon">üî¢</span>
                            Fermion Generations
                        </h3>
                        <p class="concept-description">
                            The three generations of matter (electron/muon/tau families) emerge from topological
                            properties of the G‚ÇÇ manifold, specifically its Euler characteristic.
                        </p>
                        <div class="expandable">
                            <div class="expand-header" onclick="toggleExpand(this)">
                                <h4>Learn More</h4>
                                <span class="expand-arrow">‚ñº</span>
                            </div>
                            <div class="expand-content">
                                <p><strong>Topological Origin:</strong></p>
                                <div id="generation-formula-detail" style="margin: 1rem 0;">
                                    Loading formula details...
                                </div>
                                <p style="margin-top: 1rem;">
                                    The number 3 is not arbitrary but derived from the allowed topology of
                                    compact G‚ÇÇ manifolds. The Euler characteristic œá = -16 directly determines
                                    the index of the Dirac operator, yielding exactly three chiral fermion families.
                                </p>
                            </div>
                        </div>
                    </div>

                    <div class="concept-card">
                        <h3>
                            <span class="concept-icon">üî≠</span>
                            Kaluza-Klein Modes
                        </h3>
                        <p class="concept-description">
                            Excited states from the compact dimensions that manifest as heavy particles. Their
                            mass spectrum encodes information about the geometry of the extra dimensions.
                        </p>
                        <div class="expandable">
                            <div class="expand-header" onclick="toggleExpand(this)">
                                <h4>Learn More</h4>
                                <span class="expand-arrow">‚ñº</span>
                            </div>
                            <div class="expand-content">
                                <p><strong>Mass Scale:</strong></p>
                                <div style="text-align: center; margin: 1rem 0; font-size: 1.2rem;">
                                    M<sub>KK</sub> ‚âà <span data-pm-value="simulations.kk_spectrum.m_kk_gev"
                                        data-format="scientific:2" class="pm-value">...</span> GeV
                                </div>
                                <p style="margin-top: 1rem;">
                                    <strong>Observable Effects:</strong> While too heavy for direct production at
                                    current colliders, KK modes affect precision observables through virtual loops
                                    and modify gauge coupling running.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- Tab: Core Formulas -->
        <div id="formulas-content" class="tab-content" style="display: none;">
            <section class="key-formulas">
                <h3>üßÆ Essential Formulas</h3>
                <p style="color: var(--text-secondary); margin-bottom: 2rem;">
                    These are the fundamental equations that define the theory. All formulas are loaded
                    dynamically from theory_output.json.
                </p>

                <div id="formulas-list">
                    <!-- Formulas will be populated dynamically -->
                    <p style="text-align: center; color: var(--accent-info);">Loading formulas...</p>
                </div>
            </section>

            <section class="key-formulas" style="margin-top: 2rem;">
                <h3>üìä Key Parameters</h3>
                <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
                    Critical numerical values from simulations and theory.
                </p>

                <div class="param-grid">
                    <div class="param-item">
                        <div class="param-label">Bulk Dimensions</div>
                        <div class="param-value">
                            <span data-pm-value="dimensions.D_BULK" class="pm-value">...</span>
                        </div>
                    </div>
                    <div class="param-item">
                        <div class="param-label">G‚ÇÇ Dimensions</div>
                        <div class="param-value">
                            <span data-pm-value="dimensions.D_G2" class="pm-value">...</span>
                        </div>
                    </div>
                    <div class="param-item">
                        <div class="param-label">Observable Dimensions</div>
                        <div class="param-value">
                            <span data-pm-value="dimensions.D_OBSERVABLE" class="pm-value">...</span>
                        </div>
                    </div>
                    <div class="param-item">
                        <div class="param-label">Euler Characteristic</div>
                        <div class="param-value">
                            <span data-pm-value="simulations.fermion_generations.chi" class="pm-value">...</span>
                        </div>
                    </div>
                    <div class="param-item">
                        <div class="param-label">GUT Scale (GeV)</div>
                        <div class="param-value">
                            <span data-pm-value="simulations.gauge_unification.lambda_gut_gev" data-format="scientific:2" class="pm-value">...</span>
                        </div>
                    </div>
                    <div class="param-item">
                        <div class="param-label">KK Mass (GeV)</div>
                        <div class="param-value">
                            <span data-pm-value="simulations.kk_spectrum.m_kk_gev" data-format="scientific:2" class="pm-value">...</span>
                        </div>
                    </div>
                    <div class="param-item">
                        <div class="param-label">Proton Lifetime (years)</div>
                        <div class="param-value">
                            <span data-pm-value="simulations.proton_decay.tau_p_years" data-format="scientific:2" class="pm-value">...</span>
                        </div>
                    </div>
                    <div class="param-item">
                        <div class="param-label">Pneuma Coupling Œæ</div>
                        <div class="param-value">
                            <span data-pm-value="simulations.pneuma_stability.xi" class="pm-value">...</span>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- Tab: Detailed Sections -->
        <div id="sections-content" class="tab-content" style="display: none;">
            <section class="section-links">
                <h3>üìö Detailed Theory Sections</h3>
                <p style="color: var(--text-secondary); margin-bottom: 2rem;">
                    Explore the complete theory in depth. Click any section to view the full content.
                </p>

                <div id="sections-list">
                    <!-- Sections will be populated dynamically from sections.json -->
                    <p style="text-align: center; color: var(--accent-info);">Loading sections...</p>
                </div>

                <div style="margin-top: 2rem; padding: 1.5rem; background: rgba(139, 127, 255, 0.1); border-radius: 12px;">
                    <h4 style="color: var(--accent-primary); margin-bottom: 1rem;">üîó Additional Resources</h4>
                    <ul style="line-height: 2;">
                        <li><a href="simulations.html" style="color: var(--accent-info);">Computational Simulations</a> - View all simulation results</li>
                        <li><a href="references.html" style="color: var(--accent-info);">References</a> - Complete bibliography</li>
                        <li><a href="appendices.html" style="color: var(--accent-info);">Technical Appendices</a> - Detailed derivations</li>
                        <li><a href="paper.html" style="color: var(--accent-info);">Full Paper</a> - Complete academic manuscript</li>
                    </ul>
                </div>
            </section>
        </div>
    </div>

    <script>
        // Tab switching
        function showTab(tabName) {
            // Hide all tab contents
            const tabs = ['basics', 'concepts', 'formulas', 'sections'];
            tabs.forEach(tab => {
                const content = document.getElementById(tab + '-content');
                if (content) content.style.display = 'none';
            });

            // Remove active class from all tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected tab
            const selectedContent = document.getElementById(tabName + '-content');
            if (selectedContent) selectedContent.style.display = 'block';

            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        // Expandable sections
        function toggleExpand(header) {
            header.classList.toggle('active');
            const content = header.nextElementSibling;
            content.classList.toggle('active');
        }

        // Load sections from sections.json
        async function loadSections() {
            const pathPrefixes = ['', 'AUTO_GENERATED/', '../', '../AUTO_GENERATED/'];

            for (const prefix of pathPrefixes) {
                try {
                    const response = await fetch(prefix + 'json/sections.json');
                    if (response.ok) {
                        const sections = await response.json();
                        console.log(`Loaded sections from ${prefix}json/sections.json`);
                        return sections;
                    }
                } catch (e) {
                    continue;
                }
            }

            console.error('Failed to load sections.json');
            return null;
        }

        // Initialize when PM data is loaded
        async function initializePage() {
            // Wait for PM to load
            if (window.PM && window.PM.load) {
                await window.PM.load();
            }

            // Wait for PMFormulaLoader to load
            if (window.PMFormulaLoader && window.PMFormulaLoader.load) {
                await window.PMFormulaLoader.load();
            }

            // Load sections
            const sections = await loadSections();
            if (sections) {
                window.PM_SECTIONS = sections;
            }

            // Update stats in header
            updateStats();

            // Populate sections tab
            populateSections();

            // Populate concepts tab with beginner summaries
            populateConcepts();

            // Populate formulas section
            populateFormulas();

            // Load specific formula displays
            loadSpecificFormulas();
        }

        function updateStats() {
            // Formula count
            const formulaCount = Object.keys(window.PM?.formulas || {}).length;
            document.getElementById('formula-count').textContent = formulaCount;

            // Section count from loaded sections
            const sectionCount = window.PM_SECTIONS ? Object.keys(window.PM_SECTIONS).length : 6;
            document.getElementById('section-count').textContent = sectionCount;
        }

        function populateSections() {
            const sectionsList = document.getElementById('sections-list');
            if (!sectionsList || !window.PM_SECTIONS) return;

            const sections = window.PM_SECTIONS;
            const sectionKeys = Object.keys(sections).sort((a, b) => parseInt(a) - parseInt(b));

            if (sectionKeys.length === 0) {
                sectionsList.innerHTML = '<p style="text-align: center; color: var(--text-secondary);">No sections loaded. Run: python run_all_simulations.py --export</p>';
                return;
            }

            let html = '';
            sectionKeys.forEach(key => {
                const section = sections[key];
                if (section.sectionType === 'section') { // Only main sections, not appendices
                    html += `
                        <a href="${section.sectionFile || 'sections/' + section.title.toLowerCase().replace(/\s+/g, '-') + '.html'}" class="section-link-item">
                            <span class="section-number">${section.id}</span>
                            <div>
                                <strong>${section.title}</strong>
                                <div style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 0.25rem;">
                                    ${section.beginnerSummary || section.abstract || ''}
                                </div>
                            </div>
                        </a>
                    `;
                }
            });

            sectionsList.innerHTML = html;
        }

        function populateConcepts() {
            // Update the Key Concepts tab with beginner summaries from sections.json
            if (!window.PM_SECTIONS) return;

            const sections = window.PM_SECTIONS;
            const sectionKeys = Object.keys(sections).sort((a, b) => parseInt(a) - parseInt(b));

            // Populate section summaries in the Basics tab
            const summariesGrid = document.getElementById('summaries-grid');
            if (summariesGrid) {
                let html = '';
                sectionKeys.forEach(key => {
                    const section = sections[key];
                    if (section.sectionType === 'section' && section.beginnerSummary) {
                        const icons = ['üéØ', 'üìê', '‚öõÔ∏è', 'üî¨', 'üåå', 'üéì'];
                        const icon = icons[parseInt(key) - 1] || 'üìÑ';

                        html += `
                            <div class="concept-card">
                                <h3>
                                    <span class="concept-icon">${icon}</span>
                                    ${section.title}
                                </h3>
                                <p class="concept-description">
                                    ${section.beginnerSummary}
                                </p>
                                ${section.keyTakeaways && section.keyTakeaways.length > 0 ? `
                                    <div class="expandable">
                                        <div class="expand-header" onclick="toggleExpand(this)">
                                            <h4>Key Takeaways</h4>
                                            <span class="expand-arrow">‚ñº</span>
                                        </div>
                                        <div class="expand-content">
                                            <ul style="margin: 1rem 0; line-height: 1.8;">
                                                ${section.keyTakeaways.map(t => `<li>${t}</li>`).join('')}
                                            </ul>
                                        </div>
                                    </div>
                                ` : ''}
                            </div>
                        `;
                    }
                });

                if (html) {
                    summariesGrid.innerHTML = html;
                } else {
                    summariesGrid.innerHTML = '<p style="text-align: center; color: var(--text-secondary);">No section summaries available.</p>';
                }
            }
        }

        function populateFormulas() {
            const formulasList = document.getElementById('formulas-list');
            if (!formulasList) return;

            const formulas = window.PMFormulaLoader?.getAll() || {};
            const formulaKeys = Object.keys(formulas);

            if (formulaKeys.length === 0) {
                formulasList.innerHTML = '<p style="text-align: center; color: var(--text-secondary);">No formulas loaded. Run: python run_all_simulations.py --export</p>';
                return;
            }

            // Select key formulas to display
            const keyFormulaIds = [
                'generation-number',
                'gauge-coupling-evolution',
                'proton-decay-rate',
                'kk-mass-scale',
                'neutrino-mass-seesaw',
                'pneuma-lagrangian'
            ];

            let html = '';
            keyFormulaIds.forEach(id => {
                const formula = formulas[id];
                if (formula) {
                    html += `
                        <div class="formula-item">
                            <div class="formula-label">${formula.label || id}</div>
                            <div style="margin: 1rem 0; font-size: 1.1rem; text-align: center;">
                                ${formula.html || formula.latex || 'Formula not available'}
                            </div>
                            ${formula.description ? `<div class="formula-description">${formula.description}</div>` : ''}
                        </div>
                    `;
                }
            });

            if (html) {
                formulasList.innerHTML = html;
                // Trigger MathJax rendering
                if (window.MathJax && window.MathJax.typesetPromise) {
                    window.MathJax.typesetPromise([formulasList]);
                }
            } else {
                formulasList.innerHTML = '<p style="text-align: center; color: var(--text-secondary);">Key formulas not found in theory_output.json</p>';
            }
        }

        function loadSpecificFormulas() {
            // Load generation number formula for intermediate card
            const genFormula = window.PMFormulaLoader?.get('generation-number');
            if (genFormula) {
                const genDisplay = document.getElementById('gen-formula-display');
                if (genDisplay) {
                    genDisplay.innerHTML = genFormula.html || genFormula.latex || 'N<sub>gen</sub> = |œá|/16 = 3';
                }

                const genDetail = document.getElementById('generation-formula-detail');
                if (genDetail) {
                    genDetail.innerHTML = `
                        <div style="background: rgba(139, 127, 255, 0.1); padding: 1rem; border-radius: 8px; text-align: center;">
                            ${genFormula.html || genFormula.latex || 'N<sub>gen</sub> = |œá|/16 = 3'}
                        </div>
                        <p style="margin-top: 1rem;">
                            Where œá = <span data-pm-value="simulations.fermion_generations.chi" class="pm-value">-16</span>
                            is the Euler characteristic of the G‚ÇÇ manifold.
                        </p>
                    `;
                    // Update PM values
                    if (window.PM && window.PM.updateDOM) {
                        window.PM.updateDOM();
                    }
                }

                // Trigger MathJax
                if (window.MathJax && window.MathJax.typesetPromise) {
                    window.MathJax.typesetPromise();
                }
            }
        }

        // Initialize on page load
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializePage);
        } else {
            initializePage();
        }

        // Refresh when PM finishes loading
        window.addEventListener('load', () => {
            setTimeout(() => {
                if (window.PM && window.PM._loaded) {
                    updateStats();
                    populateSections();
                    populateConcepts();
                    populateFormulas();
                    loadSpecificFormulas();
                }
            }, 500);
        });
    </script>

    <script type="module">
        import { setupAuthGuard } from './js/auth-guard.js';
        setupAuthGuard('foundations');
    </script>
</body>
</html>
