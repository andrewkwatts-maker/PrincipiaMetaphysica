# Simulations Page Dynamic Update - Summary

**Date**: 2025-12-28
**Task**: Create dynamic simulations page with auto-generated index

## Overview

Transformed the static simulations page into a fully dynamic, searchable interface that automatically indexes all simulation scripts from the repository.

## Files Created

### 1. `simulations/Constants/generate_simulations_index.py`

**Purpose**: Auto-generates comprehensive simulation index from directory scan

**Features**:
- Recursively scans `simulations/` directory for all `.py` files
- Extracts metadata from each file:
  - Filename and relative path
  - Version number from filename (e.g., `v15_0` -> `15.0`)
  - Title from docstring (after "PRINCIPIA METAPHYSICA - ")
  - Description (first substantial line in docstring)
  - Status keywords (CORE, PREDICTION, VALIDATED, GEOMETRIC)
- Auto-categorizes scripts by:
  - Directory structure (`deprecated/`, `adhoc/`, `validation/`, etc.)
  - Filename keywords (gauge, neutrino, g2, quantum, cosmology, etc.)
- Groups scripts by category and sorts by version (descending)
- Outputs to: `AutoGenerated/simulations-index.json`

**Categories**:
- Core Physics
- Gauge Unification
- Neutrino Physics
- G2 Geometry
- Quantum Biology
- Cosmology
- Moduli Stabilization
- Yukawa & Fermion Masses
- Proton Decay
- KK Spectrum
- Deprecated
- Ad-Hoc / Experimental
- Validation
- Constants & Utilities

**Usage**:
```bash
cd simulations/Constants
python generate_simulations_index.py
```

## Files Modified

### 2. `simulations.html`

**Major Changes**:

#### A. Updated Index Section
- **Before**: Static hardcoded file lists
- **After**: Dynamic loading from `simulations-index.json`
- Added search box for filtering simulations
- Added statistics display (total scripts, total categories, latest version)
- Responsive category cards with script counts

#### B. New JavaScript Functions

**`loadSimulationIndex()`**
- Fetches `AutoGenerated/simulations-index.json`
- Populates stats (total scripts, categories, version)
- Triggers index and section rendering
- Sets up search functionality

**`getAllScripts()`**
- Flattens category structure into searchable array
- Adds category name to each script for grouping

**`filterSimulations(query)`**
- Filters scripts by search query
- Searches: filename, description, title, version, status
- Re-renders both index and file sections

**`renderSimulationIndex()`**
- Groups filtered scripts by category
- Renders category cards with:
  - Category title and script count
  - List of scripts with version badges
  - Status badges (CORE, PREDICTION, etc.)
  - Clickable links to scroll to file sections

**`renderSimulationSections()`**
- Generates expandable file sections grouped by category
- Each section includes:
  - Filename with version badge
  - Status badge
  - Title/description
  - Expandable content area for code display

#### C. Enhanced Styling
- Added `.index-stats` for statistics display
- Added `.status-badge` for status indicators
- Added smooth scroll behavior (`scroll-margin-top: 100px`)
- Improved category card layout
- Better responsive design

#### D. Search Functionality
- Real-time search as you type
- Searches across: file names, descriptions, titles, versions, statuses
- Filters both index and file sections simultaneously
- Empty state message when no results

## Output Format

### `simulations-index.json`

```json
{
  "version": "16.2",
  "generated": "2025-12-28T12:34:56Z",
  "total_scripts": 91,
  "categories": {
    "Gauge Unification": {
      "title": "Gauge Unification",
      "path": "simulations/",
      "scripts": [
        {
          "file": "gauge_unification_precision_v12_4.py",
          "path": "simulations/gauge_unification_precision_v12_4.py",
          "version": "12.4",
          "title": "Gauge Unification Precision",
          "description": "M_GUT and gauge coupling unification via RG flow",
          "status": "CORE"
        }
      ],
      "count": 5
    }
  }
}
```

## User Experience Improvements

### Before
- Static list of hardcoded simulation files
- Manual updates required when adding new scripts
- No search or filtering
- Limited metadata display
- GitHub API dependency (rate-limited)

### After
- Fully dynamic, auto-generated index
- Add new scripts and re-run generator - instant updates
- Real-time search across all metadata
- Rich metadata: versions, status, titles, descriptions
- No external API dependencies (works offline)
- Organized by category with counts
- Better visual hierarchy with badges and cards

## Workflow

### For Developers

1. **Add new simulation script** to `simulations/` directory
2. **Include proper docstring** with title and description:
   ```python
   """
   PRINCIPIA METAPHYSICA v15.0 - Script Title
   ==========================================

   Brief description of what this script does.

   STATUS: CORE  # or PREDICTION, VALIDATED, GEOMETRIC
   """
   ```
3. **Run index generator**:
   ```bash
   python simulations/Constants/generate_simulations_index.py
   ```
4. **Refresh webpage** - new script appears automatically!

### For Users

1. **Browse** categorized index
2. **Search** by keyword, version, or status
3. **Click** script name to scroll to details
4. **Expand** to view full source code
5. **Filter** by search to find specific simulations

## Technical Details

### Metadata Extraction
- Uses regex to parse Python docstrings
- Looks for "PRINCIPIA METAPHYSICA - {title}" pattern
- Extracts first substantial line as description
- Detects status keywords in docstring body

### Version Parsing
- Regex pattern: `_v(\d+)_(\d+)\.py` -> `15.0`
- Fallback: `_v(\d+)\.py` -> `15.0`
- Supports both underscore and dot separators

### Category Assignment
- Priority 1: Directory structure (deprecated, adhoc, etc.)
- Priority 2: Filename keywords (gauge, neutrino, g2, etc.)
- Fallback: "Simulations" category

### Search Algorithm
- Case-insensitive substring matching
- Searches all text fields simultaneously
- Returns union of all matches
- Real-time filtering (no debouncing needed)

## Benefits

1. **Maintainability**: One script to update entire index
2. **Scalability**: Handles hundreds of simulations easily
3. **Discoverability**: Search makes finding scripts trivial
4. **Documentation**: Enforces docstring standards
5. **Automation**: No manual HTML editing required
6. **Offline**: No GitHub API dependency
7. **Fast**: JSON loading is instant
8. **Accurate**: Always reflects current directory state

## Future Enhancements

Possible improvements:
- Add category filters (pill buttons like formulas.html)
- Sort options (by version, alphabetical, date)
- Tag system for cross-category grouping
- Dependency graph visualization
- Integration with theory_output.json for validation status
- Script runtime statistics
- Download/copy code buttons
- Syntax highlighting improvements

## Testing

To test the implementation:

1. Run the generator script:
   ```bash
   python simulations/Constants/generate_simulations_index.py
   ```

2. Verify `AutoGenerated/simulations-index.json` is created

3. Open `simulations.html` in browser

4. Verify:
   - Index loads with all categories
   - Stats display correctly
   - Search filters work
   - Clicking script names scrolls to sections
   - File sections render with metadata
   - Expandable sections work for code display

## Conclusion

The simulations page is now a powerful, dynamic tool for browsing and discovering the extensive simulation codebase. The auto-generation approach ensures the page stays in sync with the repository, while the search functionality makes finding specific scripts effortless.

The system is maintainable, scalable, and user-friendly - a significant upgrade from the previous static implementation.
