<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Test Predictions Dashboard</title>
  <script src="js/theory-constants.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 2rem;
      background: #1a1a2e;
      color: #eee;
    }
    .test-result {
      padding: 1rem;
      margin: 1rem 0;
      border-radius: 8px;
      border: 1px solid #444;
    }
    .success { background: rgba(81, 207, 102, 0.1); border-color: #51cf66; }
    .error { background: rgba(255, 87, 87, 0.1); border-color: #ff5757; }
    pre {
      background: #000;
      padding: 1rem;
      border-radius: 4px;
      overflow-x: auto;
    }
  </style>
</head>
<body>
  <h1>Predictions Dashboard Test</h1>

  <div id="test-results"></div>

  <script>
    const results = [];

    // Test 1: TheoryConstants loaded
    try {
      if (typeof TheoryConstants !== 'undefined') {
        results.push({
          test: 'TheoryConstants loaded',
          status: 'success',
          data: 'TheoryConstants object exists'
        });
      } else {
        throw new Error('TheoryConstants not found');
      }
    } catch (e) {
      results.push({
        test: 'TheoryConstants loaded',
        status: 'error',
        data: e.message
      });
    }

    // Test 2: Key values present
    try {
      const TC = TheoryConstants;
      const tests = {
        'generations': TC.topology.generations,
        'w_a': TC.darkEnergy.wa,
        'w_0': TC.darkEnergy.w0,
        'm_KK': TC.v61Predictions.mKKCentral,
        'Delta N_eff': TC.v61Predictions.deltaNEffCentral,
        'neutrino hierarchy': TC.neutrinos.hierarchy
      };

      let output = '';
      for (const [key, val] of Object.entries(tests)) {
        output += `${key}: ${val}\n`;
      }

      results.push({
        test: 'Key prediction values',
        status: 'success',
        data: output
      });
    } catch (e) {
      results.push({
        test: 'Key prediction values',
        status: 'error',
        data: e.message
      });
    }

    // Test 3: Calculations work
    try {
      const TC = TheoryConstants;

      // w_a calculation
      const wa_calc = TC.darkEnergy.wa;

      // m_KK range check
      const mkk_valid = TC.v61Predictions.mKKCentral >= TC.v61Predictions.mKKMin
                     && TC.v61Predictions.mKKCentral <= TC.v61Predictions.mKKMax;

      // Swampland constraint
      const swampland_valid = TC.moduli.aSwampland > TC.moduli.swamplandBound;

      const output = `w_a = ${wa_calc} ✓
m_KK in range [${TC.v61Predictions.mKKMin}, ${TC.v61Predictions.mKKMax}]: ${mkk_valid ? 'YES' : 'NO'}
Swampland: ${TC.moduli.aSwampland.toFixed(3)} > ${TC.moduli.swamplandBound.toFixed(3)}: ${swampland_valid ? 'YES' : 'NO'}`;

      results.push({
        test: 'Validation checks',
        status: 'success',
        data: output
      });
    } catch (e) {
      results.push({
        test: 'Validation checks',
        status: 'error',
        data: e.message
      });
    }

    // Render results
    const container = document.getElementById('test-results');
    let html = '';

    results.forEach(result => {
      html += `<div class="test-result ${result.status}">`;
      html += `<h3>${result.test}: ${result.status === 'success' ? '✓ PASS' : '✗ FAIL'}</h3>`;
      html += `<pre>${result.data}</pre>`;
      html += `</div>`;
    });

    const passCount = results.filter(r => r.status === 'success').length;
    const totalCount = results.length;

    html = `<h2>Test Results: ${passCount}/${totalCount} passed</h2>` + html;

    if (passCount === totalCount) {
      html += '<div class="test-result success"><h3>All tests passed! ✓</h3><p>Predictions dashboard ready to use.</p></div>';
    } else {
      html += '<div class="test-result error"><h3>Some tests failed ✗</h3><p>Check the errors above.</p></div>';
    }

    container.innerHTML = html;
  </script>
</body>
</html>
