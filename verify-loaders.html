<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quick Loader Verification</title>
    <style>
        body {
            font-family: monospace;
            max-width: 800px;
            margin: 2rem auto;
            padding: 2rem;
            background: #1a1a2e;
            color: #e0e0e0;
        }
        .status { padding: 1rem; margin: 1rem 0; border-radius: 4px; }
        .success { background: rgba(74, 222, 128, 0.2); border-left: 4px solid #4ade80; }
        .error { background: rgba(248, 113, 113, 0.2); border-left: 4px solid #f87171; }
        .info { background: rgba(96, 165, 250, 0.2); border-left: 4px solid #60a5fa; }
        h1 { color: #8b7fff; }
        pre { background: #252540; padding: 1rem; border-radius: 4px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>Loader Verification</h1>
    <div id="status">Checking loaders...</div>

    <script src="js/pm-constants-loader.js"></script>
    <script src="js/pm-formula-loader.js"></script>

    <script>
        async function verify() {
            const statusDiv = document.getElementById('status');
            const results = [];

            // Wait for loaders
            await new Promise(resolve => setTimeout(resolve, 2000));

            // Check PM
            if (window.PM && window.PM._loaded) {
                results.push(`<div class="status success">
                    ✅ PM Constants Loader: SUCCESS<br>
                    Version: ${window.PM.version}<br>
                    Simulations: ${Object.keys(window.PM._data?.simulations || {}).length}<br>
                    Formulas: ${window.PM._data?.formulas?.count || 0}<br>
                    Parameters: ${Object.keys(window.PM._data?.parameters || {}).length}
                </div>`);
            } else {
                results.push(`<div class="status error">
                    ❌ PM Constants Loader: FAILED<br>
                    Error: ${window.PM?._error || 'Unknown'}<br>
                    <br>
                    Solution: Run <code>python run_all_simulations.py --export</code>
                </div>`);
            }

            // Check PMFormulaLoader
            if (window.PMFormulaLoader && window.PMFormulaLoader._loaded) {
                results.push(`<div class="status success">
                    ✅ PM Formula Loader: SUCCESS<br>
                    Formulas: ${Object.keys(window.PMFormulaLoader._formulas || {}).length}<br>
                    Version: ${window.PMFormulaLoader._version}
                </div>`);
            } else {
                results.push(`<div class="status error">
                    ❌ PM Formula Loader: FAILED<br>
                    <br>
                    Solution: Run <code>python run_all_simulations.py --export</code>
                </div>`);
            }

            // Check global objects
            results.push(`<div class="status info">
                Global Objects:<br>
                window.PM: ${window.PM ? '✅' : '❌'}<br>
                window.PM_DATA: ${window.PM_DATA ? '✅' : '❌'}<br>
                window.PM_FORMULAS: ${window.PM_FORMULAS ? '✅' : '❌'}<br>
                window.PMFormulaLoader: ${window.PMFormulaLoader ? '✅' : '❌'}
            </div>`);

            // Quick data test
            if (window.PM && window.PM._loaded) {
                const testValue = window.PM.get('simulations.proton_decay.tau_p_years');
                results.push(`<div class="status info">
                    Test Data Access:<br>
                    PM.get('simulations.proton_decay.tau_p_years') = ${testValue || 'N/A'}
                </div>`);
            }

            // Show console messages
            results.push(`<div class="status info">
                <strong>Console Output:</strong><br>
                <small>Check browser console (F12) for detailed path information</small>
            </div>`);

            statusDiv.innerHTML = results.join('');
        }

        verify();
    </script>
</body>
</html>
