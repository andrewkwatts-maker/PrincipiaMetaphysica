# PM v16.1 Publication Plotting System

## Overview

The `generate_pm_plots_v16_1.py` script generates four high-quality publication plots for Principia Metaphysica v16.1. All plots are saved at 300 DPI for print quality and use publication-standard formatting.

## Installation

Required packages:
```bash
pip install matplotlib numpy
```

## Usage

### Generate All Plots

```bash
python simulations/generate_pm_plots_v16_1.py
```

This will create four plots in `AutoGenerated/plots/`:

1. `neutrino_mixing_contours_v16_1.png`
2. `hubble_tension_v16_1.png`
3. `hubble_evolution_v16_1.png`
4. `theory_residuals_v16_1.png`

### Generate Individual Plots

```python
from simulations.generate_pm_plots_v16_1 import (
    plot_neutrino_mixing_contours,
    plot_hubble_tension,
    plot_hubble_evolution,
    plot_theory_residuals,
    load_theory_data
)

# Load theory data
theory_data = load_theory_data("AutoGenerated/theory_output.json")

# Generate individual plots
plot_neutrino_mixing_contours(theory_data=theory_data)
plot_hubble_tension(theory_data=theory_data)
plot_hubble_evolution(theory_data=theory_data)
plot_theory_residuals(theory_data=theory_data)
```

## Plot Descriptions

### 1. Neutrino Mixing Contours (`neutrino_mixing_contours_v16_1.png`)

**Purpose:** Shows PM prediction for neutrino mixing parameters compared to NuFIT 6.0 experimental constraints.

**Features:**
- θ₂₃ vs δ_CP scatter plot
- 3σ confidence ellipses for Normal Ordering (NO) and Inverted Ordering (IO)
- PM v16.1 prediction marked with red X
- Central values from NuFIT 6.0 marked with symbols

**Data Sources:**
- PM: `neutrino.theta_23_pred = 46.08°`, `neutrino.delta_CP_pred = 232.5°`
- NuFIT NO: θ₂₃ = 45.0 ± 1.0°, δ_CP = 194 ± 25°
- NuFIT IO: θ₂₃ = 45.1 ± 1.0°, δ_CP = 286 ± 25°

### 2. Hubble Tension Resolution (`hubble_tension_v16_1.png`)

**Purpose:** Demonstrates how PM resolves the 5σ Hubble tension between CMB and local measurements.

**Features:**
- Bar chart comparing three H₀ measurements
- Error bars for experimental values
- Color coded: Blue (CMB), Red (SH0ES), Green (PM)
- Annotation explaining EDE mechanism

**Data:**
- CMB (Planck 2018): 67.4 ± 0.5 km/s/Mpc
- SH0ES (Local): 73.04 ± 1.04 km/s/Mpc
- PM v16.1 (G₂ + EDE): 73.08 km/s/Mpc (prediction)

### 3. H(z) Evolution History (`hubble_evolution_v16_1.png`)

**Purpose:** Shows Hubble parameter evolution with redshift, illustrating the Early Dark Energy (EDE) pulse mechanism.

**Features:**
- Log-log plot of H(z) vs redshift z
- ΛCDM baseline (dashed blue line)
- PM with EDE pulse (solid green line)
- EDE transition point marked at z = 3540
- Dual x-axis: redshift and scale factor

**Physical Model:**
- EDE pulse: Gaussian centered at z = 3540
- Peak fractional energy density: f_EDE ≈ 10%
- Pulse width: Δlog(1+z) ≈ 0.3
- Mechanism: G₂ moduli stabilization dynamics

### 4. Theory Residuals (`theory_residuals_v16_1.png`)

**Purpose:** Quantifies agreement between PM predictions and observations in units of standard deviations.

**Features:**
- Horizontal bar chart of σ-deviations
- Color coding: Green (<1σ), Orange (1-2σ), Red (>2σ)
- Reference lines at 1σ, 2σ, 3σ
- Average deviation shown in summary box

**Parameters:**
| Parameter | PM Value | Observed | σ-Deviation |
|-----------|----------|----------|-------------|
| H₀ (km/s/Mpc) | 73.08 | 73.04 ± 1.04 | 0.04σ |
| w₀ (DE EoS) | -0.846 | -0.827 ± 0.063 | 0.30σ |
| θ₂₃ (deg) | 46.08 | 45.0 ± 1.0 | 1.08σ |
| δ_CP (deg) | 232.5 | 194 ± 25 | 1.54σ |

**Average:** 0.74σ (excellent agreement)

## Technical Specifications

### Plot Styling

All plots use consistent publication styling:

```python
- Font: Times New Roman (serif)
- Font sizes: Labels (14pt), Ticks (12pt), Legend (11pt)
- DPI: 300 (print quality)
- Grid: Light gray, α = 0.3
- Figure size: 8×6 inches (standard) or 9×6 (wide plots)
- Format: PNG with tight bounding box
```

### Color Palette

Color-blind friendly palette used throughout:

- Blue (#3498db): CMB/ΛCDM reference
- Red (#e74c3c): SH0ES/experimental highlight
- Green (#2ecc71): PM predictions
- Orange (#f39c12): Warning/1-2σ deviations
- Dark colors: Experimental best fits

### Data Integration

The script automatically reads values from `AutoGenerated/theory_output.json`:

```python
theory_data = load_theory_data("AutoGenerated/theory_output.json")

# Extracted values:
theta23_pm = theory_data['neutrino.theta_23_pred']['value']
delta_cp_pm = theory_data['neutrino.delta_CP_pred']['value']
w0_pm = theory_data['cosmology.w0_derived']['value']
wa_pm = theory_data['cosmology.wa_derived']['value']
```

## Output

All plots are saved to `AutoGenerated/plots/` with:
- Resolution: 300 DPI (publication quality)
- Format: PNG with transparency support
- Size: ~140-240 KB per plot
- Total output: ~750 KB for all four plots

## Future Enhancements

Potential additions for future versions:

1. **PDF export** for LaTeX integration
2. **SVG export** for vector graphics
3. **Interactive plots** using plotly
4. **Animated evolution** for H(z) and w(z)
5. **Corner plots** for parameter correlations
6. **Comparison grid** showing multiple theory versions

## References

### Experimental Data

- **NuFIT 6.0:** [www.nu-fit.org](http://www.nu-fit.org) (2024)
  - Neutrino oscillation parameters from global fits

- **Planck 2018:** Planck Collaboration (2020)
  - CMB-based cosmological parameters

- **SH0ES:** Riess et al. (2022), ApJL 934, L7
  - Local distance ladder H₀ measurement

- **DESI DR2:** DESI Collaboration (2024)
  - Dark energy equation of state constraints

### Theory

- **Principia Metaphysica v16.1:** This work
  - G₂ holonomy geometric unification
  - Early Dark Energy from moduli dynamics
  - Neutrino mixing from topological geometry

## License

Copyright (c) 2025-2026 Andrew Keith Watts. All rights reserved.
